Train path: True
Valid path: True
Test path : True
Train: 1299155  Valid: 6357  Test: 10112
Train size after length-stratified subsampling: 100000
Saved cleaned & stratified data to data/processed
English char vocab size: 26
Native  char vocab size: 66

Top 20 English chars:
[('a', 174154), ('i', 64930), ('n', 60393), ('r', 57919), ('h', 56822), ('e', 47469), ('t', 42851), ('s', 42631), ('o', 34234), ('d', 31456), ('l', 31422), ('u', 29478), ('k', 29031), ('m', 27349), ('p', 21835), ('y', 19527), ('c', 19381), ('g', 19022), ('b', 18453), ('v', 15512)]

Top 20 Native chars:
[('ा', 71943), ('र', 56308), ('्', 54763), ('ि', 35941), ('न', 32886), ('क', 32080), ('स', 31604), ('े', 30752), ('ल', 30253), ('ी', 28268), ('म', 26041), ('ं', 24577), ('ो', 22760), ('व', 22173), ('त', 21327), ('प', 20757), ('य', 20681), ('ु', 17553), ('ग', 15832), ('ट', 15724)]
Device: cuda
Vocab size (incl specials): 98
Example chars: ['<pad>', '<sos>', '<eos>', '<unk>', 'a', 'ा', 'i', 'n', 'r', 'h', 'र', '्', 'e', 't', 's', 'ि', 'o', 'न', 'क', 'स']
Train batches: 782 Valid batches: 50 Test batches: 79
Transformer params: 2711138
Checkpoint found at models/transformer_trf.pth. Skipping training.
Loaded TRF checkpoint epoch 12

=== Test (greedy) ===
Exact: 0.3907238924050633 Char acc: 0.8376725242145561 Mean edit: 1.120549841772152

Sample predictions (greedy):
SRC: maitrologist  GOLD: मैट्रोलॉजिस्ट  PRED: मैट्रोलॉजिस्ट
SRC: phwcs  GOLD: पीएचडब्ल्यूसीएस  PRED: फ्वक्स
SRC: pratidwandiyon  GOLD: प्रतिद्वन्दियों  PRED: प्रतिद्वांदियों
SRC: pratiyukti  GOLD: प्रतियुक्ति  PRED: प्रतियुक्ति
SRC: eksisatens  GOLD: एक्सिसटेंस  PRED: एक्सीसेटेंस
SRC: filmnirmata  GOLD: फ़िल्मनिर्माता  PRED: फिल्मनिर्मता
SRC: adrgh  GOLD: अद्र्घ  PRED: अद्र्घ
SRC: ladhege  GOLD: लड़ेगे  PRED: लढेगे
SRC: administresh  GOLD: एडमिनिस्ट्रेश  PRED: अदमिनिस्त्रेश
SRC: shiwalapurwa  GOLD: शिवालापुरवा  PRED: शिवलापुरवा
Total test examples predicted: 10112

Top character confusions (gold -> predicted), sorted by frequency:
'ा'  ->  '<eps>'   count=1374
'्'  ->  '<eps>'   count=843
'<eps>'  ->  'ा'   count=600
'़'  ->  '<eps>'   count=390
'<eps>'  ->  '्'   count=362
'ट'  ->  'त'   count=360
'ी'  ->  'ि'   count=320
'ड'  ->  'द'   count=259
'<eps>'  ->  'े'   count=257
'न'  ->  'ं'   count=207
'ू'  ->  'ु'   count=204
'ि'  ->  'ी'   count=149
'य'  ->  '<eps>'   count=135
'ॉ'  ->  'ो'   count=127
'<eps>'  ->  '़'   count=120
'द'  ->  'ड'   count=118
'े'  ->  '<eps>'   count=114
'ं'  ->  'न'   count=102
'ं'  ->  '<eps>'   count=101
'त'  ->  'ट'   count=97
'<eps>'  ->  'ए'   count=93
'ू'  ->  '<eps>'   count=77
'ट'  ->  '<eps>'   count=77
'<eps>'  ->  'ु'   count=72
'<eps>'  ->  'ं'   count=72
'ल'  ->  '<eps>'   count=66
'ः'  ->  'ह'   count=64
'न'  ->  '<eps>'   count=64
'ु'  ->  'ू'   count=63
'त'  ->  '<eps>'   count=63

Summary of edit operation counts: {'replace': 6930, 'delete': 2935, 'insert': 1773}
Wrote char confusions to error_analysis_char_confusions.csv

Top roman n-grams (n<= 3) by error rate (min support = 20):
n=3  'bly'  support=27  errors=27  err_rate=1.000
n=3  'aik'  support=23  errors=22  err_rate=0.957
n=2  'ff'  support=22  errors=21  err_rate=0.955
n=2  'za'  support=49  errors=45  err_rate=0.918
n=2  'sy'  support=24  errors=22  err_rate=0.917
n=3  'tap'  support=22  errors=20  err_rate=0.909
n=2  'az'  support=54  errors=49  err_rate=0.907
n=3  'abl'  support=32  errors=29  err_rate=0.906
n=3  'vil'  support=32  errors=29  err_rate=0.906
n=3  'mul'  support=21  errors=19  err_rate=0.905
n=3  'wad'  support=27  errors=24  err_rate=0.889
n=3  'ees'  support=35  errors=31  err_rate=0.886
n=3  'dat'  support=26  errors=23  err_rate=0.885
n=2  'ly'  support=64  errors=56  err_rate=0.875
n=3  'iks'  support=23  errors=20  err_rate=0.870
n=1  'z'  support=165  errors=143  err_rate=0.867
n=3  'jya'  support=22  errors=19  err_rate=0.864
n=2  'cu'  support=22  errors=19  err_rate=0.864
n=3  'agr'  support=22  errors=19  err_rate=0.864
n=2  'rl'  support=28  errors=24  err_rate=0.857
n=3  'agh'  support=21  errors=18  err_rate=0.857
n=3  'sid'  support=27  errors=23  err_rate=0.852
n=3  'nal'  support=20  errors=17  err_rate=0.850
n=2  'ef'  support=20  errors=17  err_rate=0.850
n=3  'sto'  support=20  errors=17  err_rate=0.850
n=3  'jar'  support=33  errors=28  err_rate=0.848
n=3  'add'  support=38  errors=32  err_rate=0.842
n=3  'rus'  support=25  errors=21  err_rate=0.840
n=3  'nce'  support=25  errors=21  err_rate=0.840
n=2  'ob'  support=41  errors=34  err_rate=0.829
Wrote roman ngram stats to error_analysis_roman_ngrams.csv

Levenshtein edit distance over test set:
mean: 1.120549841772152 median: 1.0 max: 14

Sample errors (showing up to 30):
SRC: phwcs  GOLD: पीएचडब्ल्यूसीएस  PRED: फ्वक्स
SRC: pratidwandiyon  GOLD: प्रतिद्वन्दियों  PRED: प्रतिद्वांदियों
SRC: eksisatens  GOLD: एक्सिसटेंस  PRED: एक्सीसेटेंस
SRC: filmnirmata  GOLD: फ़िल्मनिर्माता  PRED: फिल्मनिर्मता
SRC: ladhege  GOLD: लड़ेगे  PRED: लढेगे
SRC: administresh  GOLD: एडमिनिस्ट्रेश  PRED: अदमिनिस्त्रेश
SRC: shiwalapurwa  GOLD: शिवालापुरवा  PRED: शिवलापुरवा
SRC: nirmaali  GOLD: निर्माली  PRED: निरमाली
SRC: chootie  GOLD: चूतीए  PRED: चूटी
SRC: kursiyo  GOLD: कुर्सियॉ  PRED: कुरसियो
SRC: enseeaardablyusee  GOLD: एनसीआरडब्ल्यूसी  PRED: एंसीएयरडेब्ल्यूजी
SRC: shivaalapurva  GOLD: शिवालापुरवा  PRED: शिवालापूर्व
SRC: deedablyuen  GOLD: डीडब्ल्यूएन  PRED: दीदब्ल्यूएं
SRC: praansangalee  GOLD: प्राणसंगली  PRED: प्रांसंगली
SRC: sainapur  GOLD: सैनपुर  PRED: सैनापुर
SRC: dimak  GOLD: दिमाक  PRED: दिमक
SRC: jyadaa  GOLD: ज़यादा  PRED: ज्यादा
SRC: jadule  GOLD: जडूले  PRED: जडुले
SRC: baatah  GOLD: बातः  PRED: बातह
SRC: viraangnaaon  GOLD: वीरांगनाओं  PRED: विरांगनाओं
SRC: udhegee  GOLD: उड़ेगी  PRED: उधेगी
SRC: wishwas  GOLD: विष्वास  PRED: विश्वास
SRC: aaryanas  GOLD: आर्यनस  PRED: आर्यानास
SRC: shamtal  GOLD: शमलात  PRED: शमतल
SRC: chatakate  GOLD: चटकाते  PRED: चटकते
SRC: adivadiyon  GOLD: आदिवादियों  PRED: अदिवादियों
SRC: kavyavidhaaon  GOLD: काव्यविधाओं  PRED: कव्यविधाओं
SRC: tinkaa  GOLD: टिंका  PRED: तिंका
SRC: neemkathana  GOLD: नीमकाथाना  PRED: नीमकथना
SRC: rajnitikaaron  GOLD: राजनीतिकारों  PRED: राजनितीकारों

Done. Files produced:
 - error_analysis_char_confusions.csv
 - error_analysis_roman_ngrams.csv
