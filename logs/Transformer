Train path: True
Valid path: True
Test path : True
Train: 1299155  Valid: 6357  Test: 10112
Train size after length-stratified subsampling: 100000
Saved cleaned & stratified data to data/processed
English char vocab size: 26
Native  char vocab size: 66

Top 20 English chars:
[('a', 174154), ('i', 64930), ('n', 60393), ('r', 57919), ('h', 56822), ('e', 47469), ('t', 42851), ('s', 42631), ('o', 34234), ('d', 31456), ('l', 31422), ('u', 29478), ('k', 29031), ('m', 27349), ('p', 21835), ('y', 19527), ('c', 19381), ('g', 19022), ('b', 18453), ('v', 15512)]

Top 20 Native chars:
[('ा', 71943), ('र', 56308), ('्', 54763), ('ि', 35941), ('न', 32886), ('क', 32080), ('स', 31604), ('े', 30752), ('ल', 30253), ('ी', 28268), ('म', 26041), ('ं', 24577), ('ो', 22760), ('व', 22173), ('त', 21327), ('प', 20757), ('य', 20681), ('ु', 17553), ('ग', 15832), ('ट', 15724)]
Device: cuda
Vocab size (incl specials): 98
Example chars: ['<pad>', '<sos>', '<eos>', '<unk>', 'a', 'ा', 'i', 'n', 'r', 'h', 'र', '्', 'e', 't', 's', 'ि', 'o', 'न', 'क', 'स']
Train batches: 782 Valid batches: 50 Test batches: 79
Transformer params: 2711138

=== TRF Epoch 1/12 ===
Train loss: 1.4478  Val loss: 0.6516
Val exact_acc: 0.2109  char_acc: 0.7226  mean_edit: 2.057
Saved best transformer checkpoint.

=== TRF Epoch 2/12 ===
Train loss: 0.7494  Val loss: 0.5300
Val exact_acc: 0.2754  char_acc: 0.7703  mean_edit: 1.527
Saved best transformer checkpoint.

=== TRF Epoch 3/12 ===
Train loss: 0.6068  Val loss: 0.4689
Val exact_acc: 0.3112  char_acc: 0.7970  mean_edit: 1.339
Saved best transformer checkpoint.

=== TRF Epoch 4/12 ===
Train loss: 0.5262  Val loss: 0.4373
Val exact_acc: 0.3381  char_acc: 0.8126  mean_edit: 1.232
Saved best transformer checkpoint.

=== TRF Epoch 5/12 ===
Train loss: 0.4766  Val loss: 0.4172
Val exact_acc: 0.3626  char_acc: 0.8212  mean_edit: 1.197
Saved best transformer checkpoint.

=== TRF Epoch 6/12 ===
Train loss: 0.4433  Val loss: 0.4008
Val exact_acc: 0.3744  char_acc: 0.8272  mean_edit: 1.135
Saved best transformer checkpoint.

=== TRF Epoch 7/12 ===
Train loss: 0.4184  Val loss: 0.3912
Val exact_acc: 0.3874  char_acc: 0.8319  mean_edit: 1.107
Saved best transformer checkpoint.

=== TRF Epoch 8/12 ===
Train loss: 0.3999  Val loss: 0.3854
Val exact_acc: 0.3867  char_acc: 0.8324  mean_edit: 1.106
Saved best transformer checkpoint.

=== TRF Epoch 9/12 ===
Train loss: 0.3843  Val loss: 0.3795
Val exact_acc: 0.3989  char_acc: 0.8370  mean_edit: 1.070
Saved best transformer checkpoint.

=== TRF Epoch 10/12 ===
Train loss: 0.3711  Val loss: 0.3711
Val exact_acc: 0.4055  char_acc: 0.8415  mean_edit: 1.041
Saved best transformer checkpoint.

=== TRF Epoch 11/12 ===
Train loss: 0.3599  Val loss: 0.3669
Val exact_acc: 0.4110  char_acc: 0.8433  mean_edit: 1.029
Saved best transformer checkpoint.

=== TRF Epoch 12/12 ===
Train loss: 0.3499  Val loss: 0.3648
Val exact_acc: 0.4134  char_acc: 0.8448  mean_edit: 1.021
Saved best transformer checkpoint.
Loaded TRF checkpoint epoch 12

=== Test (greedy) ===
Exact: 0.3907238924050633 Char acc: 0.8376725242145561 Mean edit: 1.120549841772152

=== Test (beam width=5) — this is slower ===
Exact (beam5): 0.39497626582278483 Char acc: 0.8388238849790596 Mean edit: 1.1120450949367089

Sample predictions (greedy):
SRC: maitrologist  GOLD: मैट्रोलॉजिस्ट  PRED: मैट्रोलॉजिस्ट
SRC: phwcs  GOLD: पीएचडब्ल्यूसीएस  PRED: फ्वक्स
SRC: pratidwandiyon  GOLD: प्रतिद्वन्दियों  PRED: प्रतिद्वांदियों
SRC: pratiyukti  GOLD: प्रतियुक्ति  PRED: प्रतियुक्ति
SRC: eksisatens  GOLD: एक्सिसटेंस  PRED: एक्सीसेटेंस
SRC: filmnirmata  GOLD: फ़िल्मनिर्माता  PRED: फिल्मनिर्मता
SRC: adrgh  GOLD: अद्र्घ  PRED: अद्र्घ
SRC: ladhege  GOLD: लड़ेगे  PRED: लढेगे
SRC: administresh  GOLD: एडमिनिस्ट्रेश  PRED: अदमिनिस्त्रेश
SRC: shiwalapurwa  GOLD: शिवालापुरवा  PRED: शिवलापुरवा
